# One-hot encode 'cluster_type'
encoder = OneHotEncoder(sparse_output=False)
cluster_type_encoded = encoder.fit_transform(df_crh[['cluster_type']])

# Check the shape of the encoded data
print(cluster_type_encoded.shape)  # This will help ensure that the encoding is producing the right shape

# Create a new DataFrame for the encoded cluster types
cluster_type_df = pd.DataFrame(cluster_type_encoded, columns=encoder.get_feature_names_out(['cluster_type']))

# Combine the encoded 'cluster_type' with 'RunningVMs' and 'hosts'
X = pd.concat([df_crh[['RunningVMs', 'hosts']], cluster_type_df], axis=1)

# Check the shape of X to ensure everything is combined correctly
print(X.shape)
