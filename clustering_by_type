# 2. Convert 'ClusterType' to numerical labels using LabelEncoder
label_encoder = LabelEncoder()
cluster_type_encoded = label_encoder.fit_transform(df['ClusterType'])

# 3. Scale 'RunningVMs'
scaler = StandardScaler()
running_vms_scaled = scaler.fit_transform(df[['RunningVMs']])

# 4. Combine the scaled 'RunningVMs' and the encoded 'ClusterType'
X = np.column_stack((cluster_type_encoded, running_vms_scaled))

# 5. Apply K-means clustering (adjust number of clusters as needed)
optimal_clusters = 3  # Adjust this based on your need
kmeans = KMeans(n_clusters=optimal_clusters, random_state=42)
df['Cluster'] = kmeans.fit_predict(X)

# 6. Calculate Centroids
centroids = kmeans.cluster_centers_

# 7. Plot Clusters and their Centroids
plt.figure(figsize=(10, 6))

# Scatter plot: color by cluster labels
scatter = plt.scatter(df['RunningVMs'], df['ClusterType'], c=df['Cluster'], cmap='viridis', marker='o')

# Plot the centroids
for i, centroid in enumerate(centroids):
    plt.scatter(centroid[1], centroid[0], color='red', marker='x', s=200, label=f'Centroid {i+1}')

# Labeling
plt.title(f'K-Means Clustering (k={optimal_clusters}) with Centroids')
plt.xlabel('RunningVMs')
plt.ylabel('ClusterType (Encoded)')
plt.colorbar(scatter, label='Cluster')

# Show the legend for centroids
plt.legend()

plt.show()
